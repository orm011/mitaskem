medRxiv preprint doi: https://doi.org/10.1101/2021.03.29.21254233 ; this version posted April 1, 2021. The copyright holder for this preprint (which was not certified by peer review) is the author/funder, who has granted medRxiv a license to display the preprint in perpetuity. It is made available under a CC-BY-NC-ND 4.0 International license .
Estimating the strength of selection for new SARS-CoV-2 variants
Christiaan H. van Dorp1,*, Emma E. Goldberg1,*, Nick Hengartner1,2, Ruian Ke1,2, and Ethan O. Romero-Severson1,2,†
1Theoretical Biology and Biophysics (T-6), Los Alamos National Laboratory, Los Alamos NM, USA 2New Mexico Consortium, Los Alamos NM, USA *These authors contributed equally to this work †Correspondence: eoromero@lanl.gov
March 29, 2021
Abstract
A challenge to controlling the SARS-CoV-2 pandemic is the ability of the virus to adapt to its new human hosts, with novel and more transmissible strains of the virus being continually identiﬁed. Yet there are no generally accepted methods to consistently estimate the relative magnitude of the change in transmissib- lity of newly emerging variants. In this paper we consider three methods for examining and quantifying positive selection of new and emerging strains of SARS-CoV-2 over an existing wild-type strain. We consider replication at the level of countries and allow for the action of other processes that can change variants’ frequencies, speciﬁcally migration and drift. We apply these methods to the D614G spike muta- tion and the variant designated B.1.1.7, in every country where there is sufﬁcient sequence data. For each of D614G and B.1.1.7, we ﬁnd evidence for strong selection (greater than 25% increased contagiousness) in more than half of countries analyzed. Our results also shows that the selective advantages of these strains are highly heterogeneous at the country level, suggesting the need for a truly global perspective on the molecular epidemiology of SARS-CoV-2.
Introduction
Recently, several genetic variants of SARS-CoV-2 have been identiﬁed that are either suspected or conﬁrmed to have mutations that increase the contagiousness of the virus above the current circulating variants [1, 2, 3]. For a short while after the emergence of SARS-CoV-2, it was believed that the adaptive evolution of SARS-CoV-2 was limited, as evidence for purifying selection was found at most sites, with the clear exception of position 614 of the spike protein [4]. However, the emergence and rise of more complex variants such as B.1.1.7 in the United Kingdom (UK) has
1 NOTE: This preprint reports new research that has not been certified by peer review and should not be used to guide clinical practice.
medRxiv preprint doi: https://doi.org/10.1101/2021.03.29.21254233 ; this version posted April 1, 2021. The copyright holder for this preprint (which was not certified by peer review) is the author/funder, who has granted medRxiv a license to display the preprint in perpetuity. It is made available under a CC-BY-NC-ND 4.0 International license .
shifted this understanding. As SARS-CoV-2 continues to adapt to transmission among humans, we can expect to see further mutations that alter the phenotype of the circulating virus [5]. Likewise, the gradual roll-out of vaccination programs globally will slowly change the immunological landscape, possibly leading to the emergence of escape strains that are partially or fully resistant to existing vaccinations [6, 7, 8]. Molecular epidemiology is a powerful framework comprised of a broad collection of methods and software designed to facilitate the analysis of pathogen genetic sequence data [1, 2, 3, 9]. These methods allow us to peer beyond what is provided by traditional epidemiological data such as case counts and death time-series, into the substructure of an epidemic by tracking the emergence and transmission of new genetic variants. Given the high extent of population mixing at both local and global levels, the time between the emergence of a new strain in one country and its global dissemination is short. Given that rapid spread, the ongoing ﬁght against COVID-19 needs new, global tools focused on rapid modeling and assessment of the risk associated with new strains of SARS-CoV-2 to support global public health action.
Several groups have investigated the selective advantage of particular SARS-CoV-2 variants, such as D614G and B.1.1.7, either qualitatively or quantitatively. The global spread of the D614G variant was ﬁrst described by Korber et al. [10]. Speciﬁcally for the UK, the selection coefﬁcient for the D614G variant has been estimated using various phylogenetic and phylodynamic methods [3]. Estimates from these methods are highly variable, often producing inconclusive answers. The increased infectiousness of the D614G variant has also been functionally explained in terms of ACE2 receptor binding [11]. The selection coefﬁcient of the B.1.1.7 variant has been estimated for England using a highly detailed deterministic epidemic model [12]. Phylodynamic approaches have led to similar results [2]. More worryingly, the B.1.1.7 variant is associated with increased mortality [13]. These changes to the SARS-CoV-2 phenotype embodied in D614G and B.1.1.7 likely represent only a small fraction of the phenotypic variability in the broader population. In this paper we consider three different approaches for analyzing global sequence data to estimate the evidence for increased contagiousness of existing strains in the context of potentially high levels of between-country movement of people. Our goal is to test the robustness of results to different modeling assumptions, and to asses these different approaches as molecular surveillance tools.
Methods
2
We use three distinct methods to study the change in frequency over time of a SARS-CoV-2 genetic variant: isotonic regression, a population genetics model, and a stochastic epidemiological model. These models represent trade-offs in mechanistic detail and computational efﬁciency. The ﬁrst takes a descriptive approach to the rise and fall of variant frequency based around rejecting a null hypothesis of limited or no change in frequency. The second incorporates the processes of selection and migration in the context of a deterministic theoretical population. The third additionally includes stochastic effects and more explicit epidemiological processes. By comparing results from these three models, we assess the robustness of our ﬁndings to the assumptions of particular methods. In all models, we compare a new variant with the circulating background variants. The new and background variants are labeled mt (for “mutant”) and
medRxiv preprint doi: https://doi.org/10.1101/2021.03.29.21254233 ; this version posted April 1, 2021. The copyright holder for this preprint (which was not certified by peer review) is the author/funder, who has granted medRxiv a license to display the preprint in perpetuity. It is made available under a CC-BY-NC-ND 4.0 International license .
wt (for “wild type”) respectively. All data and scripts can be downloaded from https://github.com/eeg-lanl/ sarscov2-selection
Data
All epidemiological data was taken from the COVID-19 Data Repository curated by the Center for Systems Science and Engineering (CSSE) at Johns Hopkins University [14], aggregated by week to reduce noise. The D614G and B.1.1.7 variant data were taken from the Los Alamos COVID-19 Viral Genome Analysis Pipeline [10, 15] and GISAID [16, 17], respectively.
Isotonic regression
The logic behind the isotonic regression method is that, if a variant is under selection strong enough to be worrying, then we should see a continual increase in its relative frequency. That is, for a variant under selection in a given country, we should be able to reject the hypothesis that it shows no increase with respect to its background. ,Fmt Let us consider modeling the time series of pairs (Fwt ) that count the number of samples identiﬁed as t t the new variant (Fmt ) and all other background sequences (Fwt ) observed on a given day t. If we assume that the t t individuals whose SARS-CoV-2 virus is sequenced are randomly selected from the pool of infected individuals, then the number of observed variant sequences Fmt , conditional on the total number of sequenced individuals Ft = Fwt t + t Fmt If the mutations that deﬁne the new variant (i.e., the genotype) , is binomial with probability pt and size Ft. t are neutral, being neither beneﬁcial nor deleterious, then the proportion pt performs a random walk with constant expectation. However, if the variant has an evolutionary advantage, then the proportion pt will have a non-decreasing expectation over time. Here, we use that observation to devise a statistical test for the null hypothesis that a genotype is not advanta- geous. This approach does not, however, provide us with an estimate of how advantageous a genotype is because it does not model the competition between variants. Let (ti,Vi), i = 1, . . . ,K denote the date and variant Vi ∈ {wt,mt} from each of the K tested individuals. Our test is based on ﬁtting isotonic logistic regressions to estimate a monotone non-decreasing probability pt to that data, and use the logarithm of the likelihood ratio of the ﬁtted isotonic model and model with constant pt as the test statistic. Unlike in regular parametric cases, that statistic does not have an asymptotic chi-square distribution. For that reason, we empirically evaluate the null distribution of the test statistic by reﬁtting the isotonic regres- sion to (ti,V (cid:63) i ), where V (cid:63) K is a random permutation of the original data V1, . . . ,VK. Fitting the isotonic logistic 1 , . . . ,V (cid:63) regression to M random permutations allows us to calculate empirically the country level p-value for the null hypothe- sis of no evolutionary advantage that are reported in Results. These were calculated in R 3.6.3 using the package cgam [18] to perform the isotonic logistic regression.
3
Population genetics model
The goal of this modeling approach is to provide a rapid means of estimating the selective advantage of a new genetic variant while also allowing for some contribution from migration. We ﬁrst describe the model within each country. Then we explain how we ﬁt it to data from all countries.
medRxiv preprint doi: https://doi.org/10.1101/2021.03.29.21254233 ; this version posted April 1, 2021. The copyright holder for this preprint (which was not certified by peer review) is the author/funder, who has granted medRxiv a license to display the preprint in perpetuity. It is made available under a CC-BY-NC-ND 4.0 International license .
The model assumes that time is measured in discrete units of generations. Within each generation, we let selection act ﬁrst and then migration. Say that p and q are the frequencies of new and background variants, respectively, at the beginning of the generation (p + q = 1). Then say that p∗ and q∗ are the variant frequencies after selection, and p(cid:48) and q(cid:48) are the frequencies after migration and hence at the beginning of the next generation.
Selection
Deﬁne the absolute ﬁtnesses of the two variants as Wwt = β and Wmt = β (1 + s). So β is the geometric growth rate in number of infected people for the original genotype, and s is the selective advantage (if s > 0) or disadvantage (if s < 0) of the new variant. For the moment, let us be explicit about population size. Deﬁne Nmt = N p and Nwt = Nq as the numbers of infected people with each variant at the beginning of this generation, where N is the total number of infected people in the population. After the selective event, which is transmission of each of the variants to new hosts, the numbers of infected people become
(1a)
(1b)
N∗ mt = WmtNmt = β (1 + s)N p N∗
N∗ wt = WwtNwt = β Nq .
Even if transmission (and recovery) alters the number of infected people, this change in population size does not affect the new variant frequencies, i.e.,
N∗ (1 + s)p β (1 + s)N p mt p∗ = = = (1c) N∗ 1 + sp β (1 + s)N p + β N(1− p) mt + N∗ wt 1− p q∗ = (1d) 1 + sp
is independent of N and of β . So even with arbitrary changes in the number of infected people over time, this simple deterministic model can track only the variant frequencies. Of course, drift can have large effects when N is small, and also when a population of any size is growing rapidly. But we leave stochastic effects to our subsequent, more complex epidemic model.
(2a)
Migration
Next, a fraction m of our population is replaced by immigrants. That is, some number of infected people leave our population, and an equal number of infected people arrive from elsewhere. We say that immigration is balanced by emigration because we are applying this same model to many populations (countries) simultaneously, and travel itself does not change the total number of infected people. The change in frequency of the new variant due to migration is
p(cid:48) = p∗(1− m) + ¯pm,
4
medRxiv preprint doi: https://doi.org/10.1101/2021.03.29.21254233 ; this version posted April 1, 2021. The copyright holder for this preprint (which was not certified by peer review) is the author/funder, who has granted medRxiv a license to display the preprint in perpetuity. It is made available under a CC-BY-NC-ND 4.0 International license .
where ¯p is the frequency of the new variant among the immigrants. To be most generous to the alternative explanation that immigration is the driving force behind increases in p, we set ¯p = 1 so
(2b)
p(cid:48) = p∗ + (1− p∗)m .
Note that if the number of infected people is increasing over time (β > 1 in the description of selection, above), our formulation with constant migration fraction m means that the number of infected travelers is also increasing over time.
Putting together the total effects of selection and migration for this generation, by substituting Eq. (1c) into Eq. (2b), (1 + s)p + (1− p)m p(cid:48) = . (3) 1 + sp
At any time t, [s(1 + s)t + m(1− m)t ]p0 + m[(1 + s)t − (1− m)t ] (4) pt = s[(1 + s)t − (1− m)t ]p0 + [m(1− s)t + s(1− m)t ]
(see Eq. (A-6)). We deﬁne t = 0 as the time at which the new variant ﬁrst appears in any country. Notice that without migration (m = 0), Eq. (4) reduces to the logistic model derived in [19].
Fitting to data
For each country, the data we use are the numbers of observations of the background (Fwt ) and the new variant (Fmt ) t t each day (t). We ﬁt these data with Bayesian binomial regression, using Eq. (4), with country as a random effect. This yields separate estimates of s, m, and p0 for each country. Because the time unit for our data is days, the estimates of s and m from the model ﬁt must be multiplied by the generation time in order to be interpreted as per-generation processes. The mean serial interval for SARS-CoV-2 is most likely between 4 and 7.8 days [20], so we use a normal distribution with mean 5.9 and standard deviation 1.15 for the mean generation time. When selection truly favors a variant due to its genetic composition, it should have a similar advantage in any country. There may be differences from country to country, though, due to chance effects. For example, if the early-infected people happen to be from a demographic with higher transmission or a city with looser enforcement of social distancing, selection may appear to be stronger. We therefore use a hierarchical model in which s is drawn for each country from a normal distribution, whose mean and variance we estimate in order to infer the consistency of selection.
The migration rate, m, is the proportion of the country’s population swapped out for the new variant each generation. This is surely quite small, especially considering travel restrictions. We therefore set an exponential prior on m with mean 0.001.
5
For numerical stability, we transform all frequencies to the logit scale (see Appendix A). Models were ﬁt with Stan [21], using 4 parallel chains of length 2000, with a warm-up phase of a 1000 iterations.
medRxiv preprint doi: https://doi.org/10.1101/2021.03.29.21254233 ; this version posted April 1, 2021. The copyright holder for this preprint (which was not certified by peer review) is the author/funder, who has granted medRxiv a license to display the preprint in perpetuity. It is made available under a CC-BY-NC-ND 4.0 International license .
Stochastic epidemic model
To take more detailed population dynamics into account, we use a stochastic compartmental Kermack-McKendrick- type model. In addition to susceptible (S), exposed (E), infectious (I), and removed (R) individuals, we keep track of individuals with severe disease (H), and stratify the exposed and infected populations into individuals infected with the background (wt) or the new variant (mt). The compartment of severe infections is used to model the observed delay between infection and death. The two strata are used to keep track of the new variant’s frequency in the population, and model its selective advantage (s). The compartmental model keeps track of the number of individuals S, E, I, H, R in the disease states S, E, I, H, R, respectively. An individual starts out susceptible, and upon infection enters the exposed compartment and then becomes infectious at rate α. An infectious individual can either become severely infected at rate ν, or recover at rate γ. Severely infected individuals either recover or die at rate ω. The total population size is denoted by N, and we write X = (S,Ewt,Emt,Iwt,Imt,H,R). The transition rates η j(X,t) between the compartments are indicated by the following diagram, and the parameters are listed in Table 1.
α w t γ Ewt Iwt I w t / N + λ β ν ω (5) S H R ν γ Emt Imt α β(1+s)Imt/N+λmt
Here the indicated rates are per capita and should be multiplied by the size of the source compartment (e.g., ηH→R(X,t) = Hω). The selective advantage of the new variant is equal to s; when s > 0, the mutant has a higher infection rate β (1 + s) than to the wild-type (β ). The other life-history traits of the virus are assumed to be identical between wild-type and mutant. To model the effects of non-pharmaceutical interventions (NPI) such as lock-downs, the infection rate β is a smoothed, piece-wise constant function of time [22]. To account for migration, we added time-dependent terms λwt and λmt to the per-capita infection rate, representing the exposure of individuals in the population to SARS-CoV-2 from other regions. The precise deﬁnitions of the time-dependent parameters β , λwt, and λmt are given in Appendix B.
Observation model
The model is ﬁt to two data streams. The ﬁrst data stream consists of weekly incidence of COVID-19 deaths D. For this reason, we keep track of an auxiliary accumulator variable ΘHR, which keeps track of all transitions from H to R within a week. After each time the incidence is observed, the accumulator variable ΘHR is set to 0. Let δ denote the probability that a severe infection leads to death and not recovery. To account for variability in δ between demographic groups or reporting errors, we use an over-dispersed negative binomial instead of a binomial or Poisson
6
medRxiv preprint doi: https://doi.org/10.1101/2021.03.29.21254233 ; this version posted April 1, 2021. The copyright holder for this preprint (which was not certified by peer review) is the author/funder, who has granted medRxiv a license to display the preprint in perpetuity. It is made available under a CC-BY-NC-ND 4.0 International license .
symbol unit value description source variant D614G B.1.1.7 region UK NL UK NL s - 0.28 0.27 0.55 0.28 selective advantage novel vari- est.a ant d−1 0.81 0.80 0.40 0.39 infection rate before lockdown est. β0 d−1 0.15 0.12 0.25 0.22 infection rate during lockdown est. β1 d−1 0.21 0.33 0.34 0.37 infection rate after lockdown est. β2 relaxation d−1 - - 0.18 0.20 infection rate after second lock- est. β3 down d 54 54 243 243 initial time - t0 d 86.6 82.5 305 298 time of lockdown est. t1 d 188 181 337 336 time of lockdown relaxation est. t2 d - - 369 365 time of second lockdown est. t3 - 0.28 0.37 3.0· 10−4 - initial mutant frequency est.b p0 d−1 - - - 5.7· 10−3 per capita infection rate due to est.b λ0 travel - 105 115 90.2 93.0 overdispersion parameter death est. rD incidence - 72.8 68.3 70.3 71.6 overdispersion parameter se- est. rF quence data d−1 0.011 0.018 0.021 0.013 overdispersion of the process est. τ noise - 8.2· 10−6 1.7· 10−5 3.3· 10−4 3.1· 10−4 initital fraction infected est. ζ - - - 0.06 0.05 fraction of the population im- [23, 24]c ξ mune at time t0 N - 66.5 17.4 66.5 17.4 population size (million) - d 3 . . . mean duration of incubation [25, 26] 1/α period d−1 1/4 . . . recovery rate from infectious [27, 28]d γ stage d−1 . . . rate of developing severe infec- [29, 30]e ν γ/50 tion d 12.5 . . . duration of severe infection [25, 26]f 1/ω - 0.3 . . . probability of dying from se- [29, 30, 31]e δ vere infection
Table 1: Parameters for the epidemic model for the United Kingdom (UK) and the Netherlands (NL) and the D614G
and B.1.1.7 variants. Notes: aEstimated. bFor the Dutch B.1.1.7 model, the initial frequency is ﬁxed to 0. Instead,
the variant is introduced due to travel from the UK. cMore recent estimates for sero-prevalence in the Netherlands
are taken from https://www.rivm.nl/pienter-corona-studie/resultaten. dThe generation interval in the SEIHR model with exponentially distributed transition times is equal to 1/α + (γ + ν)−1 ≈ 1/α + 1/γ. Hence, with
SEIHR model with exponentially distributed transition times is equal to 1/α + (γ + ν)−1 ≈ 1/α + 1/γ. Hence, with
7
an average incubation period of 3 days, we need an average infectious period of 4 days to get an average generation
time of 7 days. eBy taking the probability of developing severe infection equal to 0.02 and the probability of dying
from severe infection equal to 0.3, we arrive at a case fatality rate of 0.6%. Our choice is also comparable to mortality
rates for ICU patients [31]. fThe average time between symptom onset and death is 16.5 days. After subtracting the duration of the infections period (γ + ν)−1 ≈ 1/γ, we get an average duration of severe infection of 12.5 days.
duration of the infections period (γ + ν)−1 ≈ 1/γ, we get an average duration of severe infection of 12.5 days.
medRxiv preprint doi: https://doi.org/10.1101/2021.03.29.21254233 ; this version posted April 1, 2021. The copyright holder for this preprint (which was not certified by peer review) is the author/funder, who has granted medRxiv a license to display the preprint in perpetuity. It is made available under a CC-BY-NC-ND 4.0 International license .
likelihood function for the observed death counts. At the time of the n-th observation tn, we then get (cid:1) Dn ∼ NegBinom(cid:0)δ · ΘHR(tn),rD
(6)
(cid:1) Dn ∼ NegBinom(cid:0)δ · ΘHR(tn),rD
where the parameterization of the NegBinom((cid:96),r) distribution is such that it has mean (cid:96) and variance (cid:96) + (cid:96)2/r. The second data stream consists of the number viral samples F that were sequenced each week, and the number sequences Fmt identiﬁed as the new variant. We assume that these sequences are collected from individuals that transition from the exposed to the infectious compartment, and hence we again deﬁne accumulator variables ΘEI wt and ΘEI mt to keep track of such transitions (for wild-type and mutant infections, respectively) during the week between subsequent observation times. We deﬁne fmt = ΘEI mt/(ΘEI wt + ΘEI mt) for the fraction of individuals that were infected with the new variant. To allow for over-dispersion of sampling, we use a beta-binomial likelihood function:
(7)
Fmt n ∼ BetaBinom (Fn, fmt(tn)rF , (1− fmt(tn))rF )
where the parameter rF determines the level of over-dispersion of the sampling process. We ﬁt the model to the two data streams using sequential Monte-Carlo (SMC), where parameters are estimated with iterated particle ﬁltering as described in [32]. The details of the procedure are given in Appendix B.
Diffusion approximation of the epidemic model
Exact simulation of the Markov jump process (MJP) that deﬁnes our stochastic epidemic model is very computation- ally intensive. We therefore switch to a diffusion approximation of the MJP when population sizes become large in order to do inference more efﬁciently. This formalism allows us to incorporate two sources of noise. The ﬁrst being the process noise inherent to the MJP, which becomes negligible when the sizes of the compartments are large. We therefore introduce a second noise term that captures other origins of stochasticity that the MJP can not account for and acts on predominantly large population sizes. As above, we denote the state of the n-dimensional model (where n = 7) by X i(t) with i = 1, . . . ,n. The discrete, stochastic model is deﬁned by k = 9 state transitions
(8)
X j = 1, . . . ,k η j(X,t)−−−−→ X + ε j ,
where ε j ∈ Zn is the increment of the j-th transition. For instance, the transition H → R corresponds to the increment (0, . . . ,0,−1,1). Using the Kramers-Moyal expansion of the master equation, the MJP is mapped to a system of stochastic differential equations (SDE) that can be derived from the transitions η j and increments ε j as follows [33] (cid:113)
k k (cid:113) dX i = i = 1, . . . ,n (9) εi εi η j(X,t)dB j t , jη j(X,t)dt + j ∑ ∑ j=1 j=1
where Bt is a 9-dimensional Brownian motion, corresponding to the 9 transitions of the MJP in Eq. (5). The SDE in Eq. (9) is of the form dX = µ(X,t)dt + σ (X,t)dBt, where µ and σ describe the drift and volatility, respectively. The
8
medRxiv preprint doi: https://doi.org/10.1101/2021.03.29.21254233 ; this version posted April 1, 2021. The copyright holder for this preprint (which was not certified by peer review) is the author/funder, who has granted medRxiv a license to display the preprint in perpetuity. It is made available under a CC-BY-NC-ND 4.0 International license .
volatility matrix σ (X,t) encodes the intrinsic noise of the MJP, which is negligible compared to X when X is large. We therefore add a small second noise term to the system of SDEs that is proportional to X. After this adjustment, the SDE becomes i = 1, . . . ,n (10) dX i = µi(X,t)dt + σ i(X,t)dBt + τX id(cid:101)Bi t , where (cid:101)Bt is a n-dimensional Brownian motion, independent of Bt. The parameter τ (cid:28) 1 determines the magnitude of
where (cid:101)Bt is a n-dimensional Brownian motion, independent of Bt. The parameter τ (cid:28) 1 determines the magnitude of the additional noise term.
In Appendix B, we further describe in detail the algorithm used to switch from a discrete (MJP) to a continuous (SDE) model, and the way the initial condition of the system is determined.
Results
Isotonic regression results
Our ﬁrst approach, isotonic regression, provides a simple statistical test for relative increase of a new variant. The null hypothesis is that the daily proportion of SARS-CoV-2 cases that are the mutant variant does not increase over time. The isotonic regression method rejected this null hypothesis in 33 of 38 countries with sufﬁcient data for D614G and all 24 of the countries with sufﬁcient data for B.1.1.7 at the 5% signiﬁcance level. The results are shown as a map in Fig. 1CD. In general the isotonic regression method identiﬁes the same set of countries as the population genetic method (see below). However the computed p-value is not directly translated into an estimate for the strength of selection that is estimated from the other methods.
Population genetic model results
Our hierarchical population genetics model estimates a normal distribution from which is drawn the selection coef- ﬁcient for each country. The mean of that global distribution for s is 0.25 (90% credible interval (CrI): [0.14,0.35]) for D614G and 0.26 (90% CrI: [0.14,0.36]) for B.1.1.7, both conﬁdently greater than zero (Fig. 2AD). After allowing for variance around that mean, however (Fig. 2BE), the overall global distribution of s is substantially wider, both for D614G (90% CrI: [−0.16,0.68], Fig. 2C) and for B.1.1.7 (90% CrI: [−0.07,0.60], Fig. 2F). Uncertainty in our estimates of global s come from noise in the data, uncertainty in the mean generation time, and heterogeneity among countries.
The overall selective advantages of these two variants are estimated to be very similar, but that does not mean that they are equally transmissible. The strength of selection for a variant is measured relative to all the other genotypes present over that time frame. Because B.1.1.7 emerged after D614G became globally common, the absolute ﬁtness of B.1.1.7 is likely greater. Estimates of the selection strength for each variant in each country are shown in Fig. 3. Each variant shows much heterogeneity among countries. Our model allows for a random component in country-to-country variation in s, but the differences in estimated s among the countries likely overstates the differences in actual transmission advantage. Each country surely experiences many processes that are not included in our simple model—such as superspreader events, nonrandom sampling, or waves of travellers arriving from places with different variant frequencies—and all of
9
medRxiv preprint doi: https://doi.org/10.1101/2021.03.29.21254233 ; this version posted April 1, 2021. The copyright holder for this preprint (which was not certified by peer review) is the author/funder, who has granted medRxiv a license to display the preprint in perpetuity. It is made available under a CC-BY-NC-ND 4.0 International license .


Figure 1: Map of the results of the population genetic model and isotonic regression method. Panels A and B show the estimated selection strength for D614G and B.1.1.7 respectively. Yellow, orange, and red indicated selection coefﬁcient less than 0.3, between 0.3 and 0.6, and above 0.6 respectively. Panels C and D show the p-values from the isotonic regression method for D614G and B.1.1.7 respectively. Red and green show p-values below and above 0.05 respectively.
this heterogeneity is bundled by the model into differences in s (and m, which is constrained to be small). Furthermore, strong selection for one variant in one country does not necessarily correspond to strong selection for the other variant in that country (Fig. S2), suggesting that factors beyond country-level covariates underlie the overall heterogeneity. In estimating the selective advantage of each variant, our model allows for a contribution of migration in elevating the variant frequencies (see Methods). Because selection and migration to some extent provide alternative explanations for change in variant frequency, we ﬁnd some negative correlation between these two processes (Figs. S3 and S4). The estimates of migration are not particularly distinguishable among countries (Fig. S1), but estimates of selection nevertheless show clear differences among countries (Fig. 3). We thus conclude that the selective effect of a variant can be estimated even allowing for a reasonable amount migration. Fits of the population genetic model to each country are shown in Figs. S5 and S6 for D614G and B.1.1.7, respectively. The countries differ dramatically in sampling effort and data availability over time. The robustness of the population genetic model is tested with a more detailed epidemic model below. For this analysis, we focused on two countries—the United Kingdom and the Netherlands—for which a lot of data is available. Our focal countries show different stages of the variant trajectories, but in both the model ﬁts show relatively narrow credible intervals.
10
medRxiv preprint doi: https://doi.org/10.1101/2021.03.29.21254233 ; this version posted April 1, 2021. The copyright holder for this preprint (which was not certified by peer review) is the author/funder, who has granted medRxiv a license to display the preprint in perpetuity. It is made available under a CC-BY-NC-ND 4.0 International license .
D614G B.1.1.7
Figure 2: Estimated global distribution of selection coefﬁcients for the D614G and B.1.1.7 variants from the population genetics model. The hierarchical model estimates the mean (left column) and standard deviation (middle column) of a normal distribution from which the selection coefﬁcient, s, of each country is drawn. To compose the overall (posterior predictive) distribution of s (right column), we sampled many values of the mean and standard deviation from the posterior distribution of the model, and for each drew many samples from the normal distribution it deﬁnes. Thus, panels A and D provide the estimated mean selection coefﬁcient across countries, while panels C and F provide the overall distribution for each country’s selection coefﬁcient. In each panel, dark vertical lines mark the median, and the 90% CrIs are shaded.
Stochastic model results
The overall stochastic model ﬁts to D614G and B.1.1.7 for the UK and Netherlands are shown in Fig. 4 and 5 re- spectively. The models provide very good ﬁts to the data in both cases matching both the death time series and the change in proportions of the mutant variant in both countries. D614G shows a very similar pattern in the UK and Netherlands where the mutant was spreading in a way that is nearly indistinguishable from the wild-type strains for a period of several weeks in the early epidemic period. However, in both countries the model predicts that the mutant strain very quickly outpaces the wild-type strains and continues to become more relatively prevalent even when the overall prevalence is declining by orders of magnitude. The dynamics of B.1.1.7 in the UK and Netherlands are substantially different from both D614G and each other. In both cases the mutant strain is much slower to rise, occurring over a period of months rather than weeks
11
medRxiv preprint doi: https://doi.org/10.1101/2021.03.29.21254233 ; this version posted April 1, 2021. The copyright holder for this preprint (which was not certified by peer review) is the author/funder, who has granted medRxiv a license to display the preprint in perpetuity. It is made available under a CC-BY-NC-ND 4.0 International license .


Figure 3: Selection coefﬁcients for each country, from the population genetic model. Points mark the median, and thick and thin lines are 90% and 95% CrIs, respectively. Corresponding estimates of migration are in Fig. S1.
as was the case with D614G. In both countries, the mutant strain rises exponentially despite the large changes in the overall prevalence of COVID-19 due to changing policies and behaviors during this time. Speciﬁcally in the UK, the rise in death incidence after December 14 2020 is preceded by the rapid increase of the B.1.1.7 strain, both in frequency and absolute numbers (Fig 5). This suggests that the interventions ongoing in the UK were sufﬁcient to bring the background strains below threshold but not B.1.1.7. To further substantiate this, we calculated the instantaneous effective reproduction number (Re) using the in- ferred trajectories of the stochastic model (Fig S7). The effective reproduction number of the wild-type ﬂuctuates abound the threshold value 1 between November and December, following the increased NPI (non-pharmaceutical intervention) initiated end October [34]. As the B.1.1.7 variant has a ∼ 50% higher reproduction number, these NPI were not sufﬁcient for controlling the growth of the variant, leading to a doubling of the death incidence in January 2021 and the necessity of further stringent restrictions. This suggests that new variants with an increased ﬁtness are particularly dangerous when in-place NPI are only resulting in a marginal control of the epidemic. As the B.1.1.7 variant was most likely introduced to the Netherlands from the UK, we incorporated external forces of infection in the Netherlands (λwt and λmt in Eq. (5)) to account for this fact (see Appendix B). This process allows a source of infection in the Netherlands, governed by rate λ0 (Table 1), that is proportional to the prevalence of B.1.1.7 in the UK. We forced the migration process to zero after December 21, 2020 to account for travel restrictions from the UK to the Netherlands. Based on a sample of 100 reconstructed trajectories of the stochastic model (Fig. 5B, green curves), we estimate that at that time of the travel restriction being in place, 6694–10287 individuals were infected with the B.1.1.7 variant in the Netherlands. That is, the model suggests that the establishment of B.1.1.7 in
12
medRxiv preprint doi: https://doi.org/10.1101/2021.03.29.21254233 ; this version posted April 1, 2021. The copyright holder for this preprint (which was not certified by peer review) is the author/funder, who has granted medRxiv a license to display the preprint in perpetuity. It is made available under a CC-BY-NC-ND 4.0 International license .

Figure 4: Mechanistic model ﬁt to D614G data in the Netherlands and UK. Panels A and B show many realizations of
the prevalence of the background, Iwt, and D614G variant, Imt for the maximum likelihood model ﬁt. Panels C and D
show the number of deaths accumulated up to the week scale (black dots) and the model ﬁts to those data. The bars
around the points indicate the 95% predictive interval for the data according to the model. Panels E and F show the
proportion of sequenced genomes with a glycine on position 614 of the spike protein in a given week. The blue lines
are realizations of the model ﬁt to the data. Vertical bars on the data indicate the 95% conﬁdence intervals (CI) for the
proportion based on the number of sampled genomes.
13
medRxiv preprint doi: https://doi.org/10.1101/2021.03.29.21254233 ; this version posted April 1, 2021. The copyright holder for this preprint (which was not certified by peer review) is the author/funder, who has granted medRxiv a license to display the preprint in perpetuity. It is made available under a CC-BY-NC-ND 4.0 International license .

Figure 5: Mechanistic model ﬁt to B.1.1.7 data in the Netherlands and UK. Panels A and B show many realizations
of the prevalence of the background, Iwt, and B.1.1.7 variant, Imt for the maximum likelihood model ﬁt. Panels C and
D show the number of deaths accumulated up to the week scale (black dots) and the model ﬁts to those data. The
bars around the points indicated the 95% predictive internal for the data according to the model. Panels E and F show
the proportion of sequenced genomes classiﬁed as the B.1.1.7 variant in a given week. The blue lines are realizations
of the model ﬁt to the data. Vertical bars on the data indicate the 95% CI for the proportion based on the number of
sampled genomes.
14
medRxiv preprint doi: https://doi.org/10.1101/2021.03.29.21254233 ; this version posted April 1, 2021. The copyright holder for this preprint (which was not certified by peer review) is the author/funder, who has granted medRxiv a license to display the preprint in perpetuity. It is made available under a CC-BY-NC-ND 4.0 International license .

Figure 6: Proﬁle likelihood for the selection effect of D614G in the UK and Netherlands. The maximum likelihood estimate (MLE) is indicated by a dashed line and the 95%CI is indicated by a grey box. For the UK, we estimated a selection coefﬁcient s = 0.28 (95% CI: [0.23,0.33]), and for the Netherlands we estimated s = 0.27 (95% CI: [0.20,0.35]). The red box plots show the estimates from the population genetics model (Fig. 3).
the Netherlands was facilitated by migration from the UK, however, the major factor in the spread of B.1.1.7 in the Netherlands is its selective advantage s. The proﬁle likelihoods of s, the increase in contagiousness for the mutant variant, for the D614G and B.1.1.7 are shown in Fig. 6 and 7. The proﬁle likelihoods show well constrained estimates of s. In general the conﬁdence intervals in the mechanistic model are comparable with or more narrow than the population genetic model, which is consistent with the model being both more constrained and using more data. In addition, the population genetics model takes the uncertainty in the average length of the generation interval into account. The point estimates of s from both models are close to one another with the largest difference being about 0.12 for B.1.1.7 in the UK. Point estimates of the other model parameters are listed in Table 1. The fact that the population genetics model results in smaller estimates of s in some cases can be understand by looking at the population dynamics. The emergence of the variant is in all cases followed by increased NPI, leading to a decrease in the number of infected individuals, and also the relative growth rate of the variant. This is interpreted by the population genetics model as a smaller selection coefﬁcient.
Discussion
We have illustrated three different approaches to measuring selection effects from the global SARS-CoV-2 genetic sequence data. Our analyses all point to very strong but heterogeneous selective advantages for the D614G and B.1.1.7 variants at the country level, even allowing for both migration and drift. It is important to note that our methods look for an advantage of a given variant over whatever variants are circulating at the time, rather than against a ﬁxed reference strain. This means that the estimates of a ﬁtness advantage of B.1.1.7 in many countries is relative to a background that consists mostly of D614G. Thus, the ﬁtness of B.1.1.7 exceeds that of D614G, which itself exceeds
15
medRxiv preprint doi: https://doi.org/10.1101/2021.03.29.21254233 ; this version posted April 1, 2021. The copyright holder for this preprint (which was not certified by peer review) is the author/funder, who has granted medRxiv a license to display the preprint in perpetuity. It is made available under a CC-BY-NC-ND 4.0 International license .

Figure 7: Proﬁle likelihood for the selection effect of B.1.1.7 in the UK and Netherlands. The MLE is indicated by a dashed line and the 95%CI is indicated by a grey box. For the UK, we estimated a selection coefﬁcient s = 0.55 (95% CI: [0.50,0.60]), and for the Netherlands we estimated s = 0.28 (95% CI: [0.20,0.38]). The red box plots show the estimates from the population genetics model (Fig. 3).
the original genotype. Our stochastic epidemiologic model suggests that the level of transmissibility of currently circulating variants is sufﬁcient to reduce the qualitative effect of non-pharmaceutical interventions (NPIs) in Europe. SARS-CoV-2 is rapidly adapting to its new human hosts, and strains with elevated contagiousness will likely continue to emerge as the virus continues to adapt. This situation is challenging as elevated contagiousness narrows the range under which vaccination programs can eliminate the virus, and it also opens up the possibility of escape mutations allowing infection among vaccinated persons. Integrating molecular epidemiology surveillance into SARS- CoV-2 pipelines is essential for not only monitoring the emergence of new strains, but for establishing an early warning system to monitor for escape mutations in the era of vaccine roll-out. Each approach that we examined has its own strengths and weaknesses for how it can ﬁt into an expanded molecular epidemiology surveillance system. The isotonic regression method is easy to compute and based on the very straightforward premise that a con- sistent selective advantage should produce a continually increasing frequency of the new variant in all countries where it has been observed. However, because the method is based on a hypothesis-testing framework, there is no way to determine the strength of selection relative to the background strains. Likewise, the method could be misleading in a context where the genetic background is rapidly changing (e.g., other strains under positive selection are introduced into the population during the study period). We believe that a regression-based approach is, nevertheless, very useful for rapidly evaluating evidence of selection potentially in large-scale molecular surveillance pipelines. The population genetic model is more mechanistically explicit than the regression approach and, therefore, gives a direct estimate of the selection effect. The model also allowed us to integrate a simple migration process and to jointly estimate the parameters of selection and migration. The population genetic model is also simple enough that it was coded in a popular statistical language and ﬁt to the global data in a matter of hours on a standard laptop
16
medRxiv preprint doi: https://doi.org/10.1101/2021.03.29.21254233 ; this version posted April 1, 2021. The copyright holder for this preprint (which was not certified by peer review) is the author/funder, who has granted medRxiv a license to display the preprint in perpetuity. It is made available under a CC-BY-NC-ND 4.0 International license .
computer. Its framework to estimate country-level selection effects shaped by an overall global distribution makes it potentially quite useful for general molecular surveillance purposes. However the primary weakness of the population genetic model is that it does not account for random ﬂuctuations in the underlying populations, which, given that the point of estimating selection effects in near real-time is to give warning before the new variant becomes widespread, is potentially a problem. The stochastic mechanistic model solves this problem by explicitly modeling stochastic effects that could produce changes in variant frequency by chance alone, in addition to selection and migration. Our approach takes this idea one step further by allowing noise above what would be expected in a typical homogeneous stochastic model; our logic behind this choice is that the epidemiological model assumes homogeneous mixing at the state level, which we know to be unrealistic. In reality, transmission is occurring at much smaller local scales that can lead to sudden jumps in both the number of cases and number of observed variants; allowing for extra noise in the stochastic model makes the method less sensitive to mis-speciﬁcations such as an over-simpliﬁed population structure. Despite being more complex and using additional data, we found that the mechanistic model was in agreement with the population genetic model, suggesting that the population genetic model is a reasonable balance between computability and accuracy. All of our models (and most of the other published models) make the assumption that genomes are selected at random from the set of all possible cases. If, for example, samples were sequenced speciﬁcally because they were in contact with someone that was known to be infected by the variant under study, the data may be biased toward over-estimating the spread and hence selective advantage of the new variant. There is almost certainly some bias from the non-random processes by which samples are obtained and sequenced; however, we believe that our results are still overall valid for three reasons. First, it is unlikely that the same level of bias from non-random sampling would occur in each country to produce a similar pattern in each country; that is, countries represent semi-independent systems. Second, the evidence for selection effects includes parts of the time series before people were concerned about the spread of new variants, and, therefore, were unlikely to preferentially sequence the new variants. Third, the UK has put effort into developing a representative sample of SARS-CoV-2 genomes in their country and the estimates for the selection effects in the UK for D614G and B.1.1.7 are very close and slightly above the population average for these lineages. Several studies using other methods have similarly found D614G and B.1.1.7 to each have a selective advantage over other variants circulating contemporaneously [10, 19, 3, 12, 2]. In contrast, however, van Dorp et al. [35] found no support for a selective advantage of any of the variants they tested, including D614G. We suspect this is because their statistical test required the repeated emergence of a variant in order to draw any power. Although phylogenetic replication is an appropriate requirement in many situations, it is too conservative for identifying variants of concern on the timescale at which they emerge. Instead, to test for a selective advantage of variants that have arisen only once, power can be obtained from ﬁtting explicitly epidemiological models within one location (e.g., our stochastic model, and others [19, 3, 12, 2]) or looking for consistent effects in multiple locations with largely-distinct conditions (e.g., our isotonic regression and population genetic models, and Korber et al. [10]). A central question in any modelling endeavor is how much detail is required to accurately address the problem
17
medRxiv preprint doi: https://doi.org/10.1101/2021.03.29.21254233 ; this version posted April 1, 2021. The copyright holder for this preprint (which was not certified by peer review) is the author/funder, who has granted medRxiv a license to display the preprint in perpetuity. It is made available under a CC-BY-NC-ND 4.0 International license .
in question. In the last year, a large number of models have been developed to study various aspects of the SARS- CoV-2 pandemic, ranging from very simple [25] to extremely detailed [12]. For the purpose of estimating selective advantages of variants, we argued that (relatively) simple models are sufﬁcient. With our most complex model, we took a pragmatic approach and incorporated an additional noise term that can account for some of the unavoidable model misspeciﬁcation. Such a noise term could potentially also be included in methods that allow for more efﬁcient Bayesian inference with stochastic models [36]. The emergence of new variants with increased contagiousness or resistance mutations has the potential for signiﬁcant implications for control of COVID-19 especially given that very few countries have been able to use NPIs alone to bring the viral growth rate sub-critical for extended periods of time. Integrating modeling into surveillance systems will help facilitate early-warning systems and improve our ability to design both pharmaceutical and non- pharmaceutical interventions that can stop the spread of COVID-19.
Acknowledgements
Portions of this work were done under the auspices of the U.S. Department of Energy under contract 89233218CNA000001 and supported by National Institutes of Health (www.nih.gov) grants P01-AI131365, R01-OD011095, and R01-AI028433 (CHvD). RK, NH, and ERS were funded by the US National Science Foundation RAPID grant PHY-2031756.
Literature Cited
[1] Tegally, H. et al. Emergence and rapid spread of a new severe acute respiratory syndrome-related coronavirus 2 (SARS-CoV-2) lineage with multiple spike mutations in South Africa. medRxiv (2020). [2] Volz, E. et al. Transmission of SARS-CoV-2 lineage B.1.1.7 in England: Insights from linking epidemiological and genetic data. medRxiv (2021). [3] Volz, E. et al. Evaluating the Effects of SARS-CoV-2 Spike Mutation D614G on Transmissibility and Pathogenic- ity. Cell 184, 64–75 (2021). [4] Dearlove, B. et al. A SARS-CoV-2 vaccine candidate would likely match all currently circulating variants. Proceedings of the National Academy of Sciences 117, 23652–23662 (2020). [5] Fontanet, A. et al. SARS-CoV-2 variants and ending the COVID-19 pandemic. Lancet (2021). [6] McCarthy, K. R. et al. Recurrent deletions in the SARS-CoV-2 spike glycoprotein drive antibody escape. Science (2021). [7] Wibmer, C. K. et al. SARS-CoV-2 501Y.V2 escapes neutralization by South African COVID-19 donor plasma. bioRxiv (2021). [8] Weisblum, Y. et al. Escape from neutralizing antibodies by SARS-CoV-2 spike protein variants. eLife 9, e61312 (2020). [9] Grubaugh, N. D. et al. Tracking virus outbreaks in the twenty-ﬁrst century. Nat Microbiol 4, 10–19 (2019). [10] Korber, B. et al. Tracking Changes in SARS-CoV-2 Spike: Evidence that D614G Increases Infectivity of the
18
medRxiv preprint doi: https://doi.org/10.1101/2021.03.29.21254233 ; this version posted April 1, 2021. The copyright holder for this preprint (which was not certified by peer review) is the author/funder, who has granted medRxiv a license to display the preprint in perpetuity. It is made available under a CC-BY-NC-ND 4.0 International license .
COVID-19 Virus. Cell 182, 812–827 (2020).
[11] Yurkovetskiy, L. et al. Structural and Functional Analysis of the D614G SARS-CoV-2 Spike Protein Variant. Cell 183, 739–751 (2020). [12] Davies, N. G. et al. Estimated transmissibility and impact of SARS-CoV-2 lineage B.1.1.7 in England. Science (2021). [13] Davies, N. G. et al. Increased mortality in community-tested cases of SARS-CoV-2 lineage B.1.1.7. Nature (2021). [14] Dong, E., Du, H. & Gardner, L. An interactive web-based dashboard to track COVID-19 in real time. The Lancet Infectious Diseases 20, 533–534 (2020). [15] COVID-19 Viral Genome Analysis Pipeline. https://cov.lanl.gov (2020). [16] Elbe, S. & Buckland-Merrett, G. Data, disease and diplomacy: GISAID’s innovative contribution to global health. Glob Chall 1, 33–46 (2017). [17] Global Initiative on Sharing All Inﬂuenza Data. http://www.gisaid.org/ (2008). [18] Liao, X. & Meyer, M. C. cgam: An r package for the constrained generalized additive model. Journal of Statistical Software, Articles 89, 1–24 (2019). [19] Chen, C. et al. Quantiﬁcation of the spread of SARS-CoV-2 variant B.1.1.7 in Switzerland. medRxiv (2021). [20] Ali, S. T. et al. Serial interval of SARS-CoV-2 was shortened over time by nonpharmaceutical interventions. Science 369, 1106–1109 (2020). [21] Carpenter, B. et al. Stan: A probabilistic programming language. J. Stat. Softw. 76, 1–32 (2017). [22] Rozhnova, G. et al. Model-based evaluation of school- and non-school-related measures to control the COVID-19 pandemic. Nature Communications 12, 1614 (2021). [23] Ward, H. et al. Antibody prevalence for SARS-CoV-2 following the peak of the pandemic in england: REACT2 study in 100,000 adults. medRxiv (2020). [24] Vos, E. R. A. et al. Nationwide seroprevalence of SARS-CoV-2 and identiﬁcation of risk factors in the general population of the Netherlands during the ﬁrst epidemic wave. J Epidemiol Community Health (2020). [25] Sanche, S. et al. High Contagiousness and Rapid Spread of Severe Acute Respiratory Syndrome Coronavirus 2. Emerg Infect Dis 26, 1470–1477 (2020). [26] Zhou, F. et al. Clinical course and risk factors for mortality of adult inpatients with COVID-19 in Wuhan, China: a retrospective cohort study. Lancet 395, 1054–1062 (2020). [27] Ali, S. T. et al. Serial interval of SARS-CoV-2 was shortened over time by nonpharmaceutical interventions. Science 369, 1106–1109 (2020). [28] Lavezzo, E. et al. Suppression of a SARS-CoV-2 outbreak in the Italian municipality of Vo’. Nature 584, 425–429 (2020). [29] Wu, J. T. et al. Estimating clinical severity of COVID-19 from the transmission dynamics in Wuhan, China. Nat Med 26, 506–510 (2020).
19
medRxiv preprint doi: https://doi.org/10.1101/2021.03.29.21254233 ; this version posted April 1, 2021. The copyright holder for this preprint (which was not certified by peer review) is the author/funder, who has granted medRxiv a license to display the preprint in perpetuity. It is made available under a CC-BY-NC-ND 4.0 International license .
[30] Verity, R. et al. Estimates of the severity of coronavirus disease 2019: a model-based analysis. Lancet Infect Dis 20, 669–677 (2020). [31] Grasselli, G. et al. Baseline Characteristics and Outcomes of 1591 Patients Infected With SARS-CoV-2 Admitted to ICUs of the Lombardy Region, Italy. JAMA 323, 1574–1581 (2020). [32] Ionides, E. L., Nguyen, D., Atchadé, Y., Stoev, S. & King, A. A. Inference for dynamic and latent variable models via iterated, perturbed Bayes maps. Proceedings of the National Academy of Sciences 112, 719–724 (2015). [33] van Kampen, N. G. Stochastic processes in physics and chemistry. Elsevier, Amsterdam, 3rd edition (2007). [34] Hale, T., Webster, S., Petherick, A., Phillips, T. & Kira, B. Oxford COVID-19 Government Response Tracker (2020). [35] van Dorp, L. et al. No evidence for increased transmissibility from recurrent mutations in SARS-CoV-2. Nature Communications 11, 5986 (2020). [36] Fintzi, J. et al. Using multiple data streams to estimate and forecast SARS-CoV-2 transmission dynamics, with application to the virus spread in Orange County, California (2020). [37] Mumford, D., Series, C. & Wright, D. Indra’s Pearls: The Vision of Felix Klein. Cambridge University Press (2002). [38] Douc, R. & Cappe, O. Comparison of resampling schemes for particle ﬁltering. In ISPA 2005. Proceedings of the 4th International Symposium on Image and Signal Processing and Analysis, 2005., 64–69 (2005). 20
medRxiv preprint doi: https://doi.org/10.1101/2021.03.29.21254233 ; this version posted April 1, 2021. The copyright holder for this preprint (which was not certified by peer review) is the author/funder, who has granted medRxiv a license to display the preprint in perpetuity. It is made available under a CC-BY-NC-ND 4.0 International license .
Appendix A: Population genetics model
Variant frequencies over time Here we derive the equation for the mutant frequency pn as a function of the generation n under the population genetics model with both selection and migration (Eq 4). In the main text, we derived that the new variant’s frequency p(cid:48) in the next generation is (1 + s)p + (1− p)m p(cid:48) = . (A-1) 1 + sp We can write this slightly differently as a Möbius transformation of p:  1 + s− m m · p.
(A-2)
(1 + s− m)p + m p(cid:48) = ≡  1 + s− m m · p. sp + 1 s 1
(A-3)
In general a Möbius transformation has the form a
b In general a Möbius transformation has the form a · x ≡ ax + b cx + d , c d
(A-4)
and it has the nice property that A· (B· x) = (AB)· x for two matrices A and B (see e.g., [37]). Hence, in order to ﬁnd the variant frequency in the n-th generation, we need the n-th matrix power of  1 + s− m m  .
M =  1 + s− m m  . s 1
For this we have to diagonalize M. The eigenvalues of M are equal to 1 + s and 1− m. Then eigenvectors are given by (1,1)T and (m,−s)T . Hence, we can write M = UΛU−1 where  1 m  and Λ =  1 + s  .
0 (A-5)  and Λ =  1 + s  . 0 1− m
U =  1 m  and Λ = 1 −s
Then Mn · p0 = UΛnU−1 · p0, which is equal to
[s(1 + s)n + m(1− m)n]p0 + m[(1 + s)n − (1− m)n] . (A-6) pn = s[(1 + s)n − (1− m)n]p0 + [m(1 + s)n + s(1− m)n]
Transformation to the logit scale To avoid numerical issues during inference, we transform the mutant frequency to the logit-scale, and re-parameterize (cid:1). Then the model. Let R =(cid:0) 1 0−1 1 logit(x) = log(R· x). (A-7)
21
medRxiv preprint doi: https://doi.org/10.1101/2021.03.29.21254233 ; this version posted April 1, 2021. The copyright holder for this preprint (which was not certified by peer review) is the author/funder, who has granted medRxiv a license to display the preprint in perpetuity. It is made available under a CC-BY-NC-ND 4.0 International license .
Let r0 = R· p0 and rn = R· pn. Then (A-8) rn = (RUΛnU−1R−1)· r0, (cid:17) (cid:16) 1
(cid:17) m (cid:16) 1 and we have RU = . Hence, 0 −(m+s) (cid:0)RUΛn(RU)−1(cid:1) =
m m+s [(1 + s)n − (1− m)n] (A-9) (cid:0)RUΛn(RU)−1(cid:1) =  (1 + s)n 0 (1− m)n (cid:19)n (cid:21) (cid:20)(cid:18) 1 + s (cid:18) 1 + s (cid:19)n − 1
and therefore (cid:19)n (cid:21) m (cid:20)(cid:18) 1 + s (cid:18) 1 + s . (cid:19)n − 1 (A-10) rn = r0 + m + s 1− m 1− m This equation has a removable singularity at s = −m. To see this, we write (cid:0) 1+s (cid:21) (cid:19)k (cid:1)n − 1 (cid:20)(cid:18) 1 + s (cid:18) 1 + s (cid:19)n − 1
(cid:0) 1+s n−1 (cid:21) (cid:19)k (cid:1)n − 1 m m m (cid:20)(cid:18) 1 + s (cid:18) 1 + s 1−m = = . (cid:19)n − 1 (A-11) ∑ 1+s m + s 1− m 1− m 1− m 1− m k=0 1−m − 1
(A-12)
rn = σ nr0 + µ 1− σ n 1− σ .
Now we deﬁne σ = 1+s 1−m and µ = m/(1− m). Then we get the following re-parameterized model:
Appendix B: Stochastic epidemiological model
Time-dependent infection rate
To model the effects of government restrictions such as lock-downs, the infection rate β is a (smoothed) piece-wise constant function of time. We allow for n ∈ {3,4} epidemic stages to model e.g. unrestricted spread, lockdown, and relaxation of the lockdown [22]. We let β vary smoothly between the epidemic stages, thereby allowing for an uptake period for (release of) restrictions. More precisely, β = β (t) is deﬁned as
(B-1)
β (t) = β0 (1− Hυ (t −t1)) n−2 + βi · Hυ (t −ti) (1− Hυ (t −ti+1)) ∑ i=1 + βn−1 · Hυ (t −tn−1)
−1, with parameter υ determining where Hυ is a smoothed Heaviside function deﬁned by Hυ (t) = (1 + exp(−t/υ)) the duration of the transition period between different epidemic stages. The time-varying infection rate β is illustrated in Fig. S7A. To determine the parameter υ, we require that Hυ (∆t/2) = 95%, where ∆t is the length of the uptake period. Solving for υ, we ﬁnd υ = ∆t/(2· logit(0.95)). We set ∆t = 7 days, hence the uptake period takes a week. In the case of variant B.1.1.7 in the Netherlands, we added an external force of infection, λwt and λmt for wild- type and mutant respectively, to account for contacts with infectious individuals from the UK. Because the number of infected individuals the UK varied over time, the external infection forces of infection λwt and λmt depend on time as
22
medRxiv preprint doi: https://doi.org/10.1101/2021.03.29.21254233 ; this version posted April 1, 2021. The copyright holder for this preprint (which was not certified by peer review) is the author/funder, who has granted medRxiv a license to display the preprint in perpetuity. It is made available under a CC-BY-NC-ND 4.0 International license .
follows λwt(t) = λ0E[Iwt(t)/N(t)] ,
(B-2) λmt(t) = λ0E[Imt(t)/N(t)] .
Here, the trajectories Iwt(t)/N(t) and Imt(t)/N(t) correspond to the fraction of individuals in the UK that are infected with wild-type and mutant respectively. The expectation is taken over the ﬁltered trajectories that were reconstructed with the SMC algorithm. Finally, the scaling parameter λ0 represents the product of the contact rate between individ- uals in the two countries, and the probability of infection per contact. When we ﬁt the model to the Dutch data, the parameter λ0 is estimated, but the fraction of infectious UK citizens is assumed known.
Initial condition
To complete the description of the dynamic model, we have to specify the initial conditions. Let ζ and ξ denote the fractions of infected and removed individuals at time t0, respectively. To determine the correct balance between exposed, infectious, and severely infected individuals, we compute the eigenvalues of the Jacobian matrix of the inﬁnite population limit of the MJP model. The linearized system without the S and R compartments around the disease-free steady state with S = (1− ξ )N and R = ξ N equals   E   =  −α β (1− ξ )  E
0 d (B-3) I I 0 α −γ − ν dt   E   =  −α β (1− ξ )  E H H 0 ν −ω
We use the eigenvector X0 = (E0,I0,H0)T with ∑3 i=1 X i 0 = ζ N corresponding to the dominant eigenvalue of the Jacobian matrix in Eq. (B-3) to deﬁne the initial condition of the model. The parameter p0 determines the initial fraction of infections with the mutant virus, and hence we have Emt,0 = p0E0, Imt,0 = p0I0, Ewt,0 = (1 − p0)E0, and Iwt,0 = (1− p0)I0. We then set S0 = (1−ξ −ζ )N and R0 = ξ N. Finally, the initial state of the stochastic model is randomized by sampling from a Poisson distribution with mean equal to the deterministic initial value.
Hybrid model simulation
Because for small population sizes the diffusion approximation deﬁned by the system of SDEs in Eq. (9) breaks down, as it e.g., does not allow for ﬁxation of the mutant, we model small population sizes discretely using an adaptive tau-leap approximation of the Markov jump process (Eq. (5)). Hence, we implemented a hybrid algorithm in which variables can switch between a discrete and continuous type. At any particular time t, the system consists of continuous components X i for i ∈ C (t) and discrete elements X i for i ∈ D(t) = {1, . . . ,n}\ C (t). Since for i ∈ C (t), the continuous element X i(t) is generally non-constant, the transition rates η j(X,t) will in general be time dependent. This means that we have to integrate the following system
23
medRxiv preprint doi: https://doi.org/10.1101/2021.03.29.21254233 ; this version posted April 1, 2021. The copyright holder for this preprint (which was not certified by peer review) is the author/funder, who has granted medRxiv a license to display the preprint in perpetuity. It is made available under a CC-BY-NC-ND 4.0 International license .
of SDEs and ODEs
k k (cid:113) i ∈ C (t) dX i = εi εi η j(X,t)dB j t + τ X id(cid:101)Bi jη j(X,t)dt + j t , ∑ ∑ j=1 j=1 (B-4) dH j j ∈ E (t) ≡ { j ∈ {1, . . . ,k} : ∃i ∈ D(t) : εi j (cid:54)= 0} dt = η j(X,t) ,
Hence, we have to keep track of those transition rates η j for which the increment εi j is non-zero for a discrete com- ponent X i. The initial conditions for the hybrid system Eq B-4 are given by X i(tm) = xi m and Hj(tm) = 0. We then integrate the system until time tm+1 = tm + hm. At this point, we sample the number of stochastic events Ym that occurred in the time interval (tm,tm+1], from the Poisson distribution Ym ∼ Poisson(cid:0)∑ j∈E (tm)Hj(tm+1)(cid:1)
(B-5)
Ym ∼ Poisson(cid:0)∑ j∈E (tm)Hj(tm+1)(cid:1)
Thereafter, Ym events with index j are sampled from the categorical distribution, with probability proportional to the cumulative transition rate Hj(tm+1). The increments ε j are then added to the discrete part of the state X
(B-6)
i ∈ D(tm) X j(tm+1) (cid:55)→ X j(tm+1) + ε j i ,
After applying these Ym discrete transitions, we have to re-evaluate which components of the state are discrete and which are continuous. We choose a ﬁxed threshold T = 50 below and above the populations are discrete and continu- ous, respectively. Hence, at time tm+1 we update the partition of {1, . . . ,n} as follows
(B-7) D(tm+1) = {i : X i < T} , C (tm+1) = {i : X i ≥ T}
D(tm+1) = {i : X i < T} , C (tm+1) = {i : X i ≥ T}
Finally, we set the next initial condition xm+1 = X(tm+1) and H(tm+1) = 0 and repeat the process. The tau-leap step size hm is chosen adaptively such that the expected number of events E[Ym] within each τ-leap interval (tm,tm+1] is approximately equal to 1. To accomplish this, we choose (cid:110) hmax,(cid:0)∑ j∈E (tm)η j(X(tm),tm)(cid:1)−1(cid:111)
(B-8)
(cid:110) hm = min hmax,(cid:0)∑ j∈E (tm)η j(X(tm),tm)(cid:1)−1(cid:111)
where hmax = 1d. Between jumps, the hybrid system (Eq B-4) is integrated using the Euler-Mayurama method with a step size of min{0.01,hm}.
Sequential Monte-Carlo
The method used for inference is described in full detail and generality elsewhere [32]. Here we give a brief description highlighting some of the choices made for this particular model and data set. In order to reconstruct the latent epidemic trajectories X, given the observed data O, consisting of death in- cidence data D and genetic data Fmt and F, we use sequential Monte-Carlo (SMC). We simulate J = 104 replicates of the model (particles) forward in time from one observation time (ti−1) to the next (ti), each with different initial
24
medRxiv preprint doi: https://doi.org/10.1101/2021.03.29.21254233 ; this version posted April 1, 2021. The copyright holder for this preprint (which was not certified by peer review) is the author/funder, who has granted medRxiv a license to display the preprint in perpetuity. It is made available under a CC-BY-NC-ND 4.0 International license .
conditions Xj(ti−1). Given each of the J predicted states Xj(ti) of the model at time ti, we calculate the likelihood w j = L(Oi|Xj(ti),θ ). We then sample with replacement J particles with probability proportional to the weight w j using a systematic resampling method [38]. The re-sampled particles are used as initial condition at time ti, and we
repeat the above steps until we reach the ﬁnal observation. The Monte-Carlo estimate of the conditional likelihood of observation Oi|Oi−1, is given by the average of the
(B-9)
J 1 L(Oi|Xj(ti),θ ) L(Oi|Oi−1,θ ) = ∑ J j=1 where we write L(O1|O0,θ ) ≡ L(O1|θ ). The total likelihood of the time series given θ is equal to
weights
(B-10)
where we write L(O1|O0,θ ) ≡ L(O1|θ ). The total likelihood of the time series given θ is equal to
N L(Oi|Oi−1,θ ) L(O1, . . . ,ON|θ ) = ∏ i=1
All likelihood computations are done on the log-scale to minimize ﬂoating-point errors.
To estimate parameters, we extended the state X with the parameter vector θ, allowing the parameters to be per- turbed after each observation time. For the j-th particle, we now have a state (Xj,θ j), and weight w j = L(Oi|Xj(ti),θ j). The extended-SMC algorithm is then iterated M = 200 times, and after each iteration m the magnitude of the parameter perturbations is reduced. The perturbations are Gaussian θ j (cid:55)→ θ j + amε, with ε ∼ N (0,Σ). Here, Σ is a diagonal ma- trix with diagonal elements given in Table S1. For bounded parameters, the perturbations are reﬂected in the boundary 10−2 such of the domain. The ratio a ∈ (0,1) reduces the magnitude of the parameter perturbations. We choose a = M√
that after M iterations the magnitude of the perturbations is reduced by 99%. After each iteration of the extended-SMC
algorithm, for each particle we reset the state Xj to the a randomly sampled initial state of the epidemic model, while θ j is inherited from the previous extended-SMC iteration. To speed-up the computations, we implemented the model and SMC algorithm in C++ and used multi-threading to update particles between observations in parallel.
25
